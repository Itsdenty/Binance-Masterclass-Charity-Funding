<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<link rel="apple-touch-icon" sizes="76x76" href="./assets/img/favicon.ico">
<link rel="icon" type="image/png" href="./assets/img/favicon.ico">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<title>Binance masterclass charity funding</title>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport'/>
    
<!-- Google Font -->
<link href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,800" rel="stylesheet">
    
<!-- Font Awesome Icons -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    
<!-- Main CSS -->
<link href="./assets/css/main.css" rel="stylesheet"/>
    
<!-- Animation CSS -->
<link href="./assets/css/vendor/aos.css" rel="stylesheet"/>
    
</head>
    
<body style="background-color: grey;"> 
    
<!--------------------------------------
NAVBAR
--------------------------------------->
<nav class="topnav navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
<div class="container-fluid">
	<a class="navbar-brand" href="./index.html"><i class="fas fa-donate mr-2"></i><strong>BMCF</strong></a>
	<button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
	<span class="navbar-toggler-icon"></span>
	</button>
	<div class="navbar-collapse collapse" id="navbarColor02" style="">
		<ul class="navbar-nav mr-auto d-flex align-items-center">
			<li class="nav-item">
			<a class="nav-link" href="./index.html">Home <span class="sr-only">(current)</span></a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="about.html">About</a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="campaigns.html">Campaigns</a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="blog.html">Blog</a>
			</li>
		</ul>
		<ul class="navbar-nav ml-auto d-flex align-items-center">
			<li class="nav-item">
			<span class="col-lg-3 text-md-center text-lg-right mt-4 mb-4">
				<a href="./create-funding.html" class="btn btn-lg btn-info">Create Donation</a>
			</span>
			</li>
			<li class="nav-item">
			<span class="col-lg-3 text-md-center text-lg-right mt-4 mb-4">
				<a href="./login.html" class="btn btn-lg btn-info">Logout</a>
			</span>
			</li>
		</ul>
	</div>
</div>
</nav>
<!-- End Navbar -->
    
    <div class="container">
        <div class="row">
            <div id="dashboard-alert" style="z-index: 2000;">
            </div>
        </div>
        <div class="card-deck card-pricing text-center pt-5" id="funding-list">
        </div>
        <!-- pagination -->
    <nav aria-label="Page navigation example" class="mt-4">
        <ul class="pagination">
            <li class="page-item"><a class="page-link" href="#"><i class="fas fa-angle-left"></i></a></li>
            <li class="page-item"><a class="page-link" href="#">1</a></li>
            <li class="page-item active"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item"><a class="page-link" href="#">4</a></li>
            <li class="page-item"><a class="page-link" href="#"><i class="fas fa-angle-right"></i></a></li>
        </ul>
    </nav>
    </div>
<!--------------------------------------
HEADER
--------------------------------------->
<!-- wavy header -->
<!-- End Header -->

    
<!--------------------------------------
MAIN
--------------------------------------->

<!--------------------------------------------
FEATURES
--------------------------------------------->

<!-- Author Card -->

<!-- End Main -->

    
<!--------------------------------------
FOOTER
--------------------------------------->
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 1440 126" style="enable-background:new 0 0 1440 126;" xml:space="preserve">
<path class="bg-black" d="M685.6,38.8C418.7-11.1,170.2,9.9,0,30v96h1440V30C1252.7,52.2,1010,99.4,685.6,38.8z"/>
</svg>
<footer class="bg-black pb-5">
<div class="container">
	<div class="row">
		<div class="col-12 col-md mr-4">
		    <h5 class="mb-4 text-white">Binance Masterclass Charity Funding</h5>
			<i class="fas fa-copyright text-white"> 2021</i>
		</div>
		<div class="col-6 col-md">
			<h5 class="mb-4 text-white">About BMCF</h5>
			<ul class="list-unstyled text-small">
				<li><a class="text-muted" href="./team.html">Team</a></li>
				<li><a class="text-muted" href="./about.html">About</a></li>
				<li><a class="text-muted" href="./blog.html">Blog</a></li>
				<li><a class="text-muted" href="./campaigns.html">Campaigns</a></li>
				<li><a class="text-muted" href="#">Privacy</a></li>
				<li><a class="text-muted" href="#">Terms</a></li>
			</ul>
		</div>
		<span class="col-lg-3 text-md-center text-lg-right mt-4 mb-4">
				<a href="#" class="btn btn-lg btn-info">Add Your Campaign</a>
		</span>
	</div>
</div>
</footer>
    
    
   
<!--------------------------------------
JAVASCRIPTS
--------------------------------------->    
<script src="./assets/js/vendor/jquery.min.js" type="text/javascript"></script>
<script src="./assets/js/vendor/popper.min.js" type="text/javascript"></script>
<script src="./assets/js/vendor/bootstrap.min.js" type="text/javascript"></script>
<script src="./assets/js/functions.js" type="text/javascript"></script>
    
<!-- Animation -->
<script src="./assets/js/vendor/aos.js" type="text/javascript"></script>
<noscript>
    <style>
        *[data-aos] {
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
    </style>
</noscript>
 
<!-- Disable animation on less than 1200px, change value if you like -->
<script>
AOS.init({
  disable: function () {
    var maxWidth = 1200;
    return window.innerWidth < maxWidth;
  }
});

</script>
<script>
    let loaderStatus = 0;
    const setSuccessNotification = (text) => {
        const alertchild = `<div class="alert alert-success">
        ${text} <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">×</span>
        </button> 
        </div>`;
        document.getElementById("dashboard-alert").innerHTML = alertchild;
        setTimeout(() => {
            document.getElementById("dashboard-alert").innerHTML = "";
        }, 5000);
    },
    setErrorNotification = (text) => {
        const alertchild = `<div class="alert alert-danger">
        ${text} <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">×</span>
        </button> 
        </div>`
        document.getElementById("dashboard-alert").innerHTML = alertchild;
        setTimeout(() => {
            document.getElementById("dashboard-alert").innerHTML = "";
        }, 5000);
    },
    loader = (id) => {
      switch (loaderStatus) {
        case 0:
            document.getElementById(id).innerText = 'wait.';
            loaderStatus = 1;
            break;
        case 1:
            document.getElementById(id).innerText = 'wait..';
            loaderStatus = 2;
            break;
        case 2:
            document.getElementById(id).innerText = 'wait...';
            loaderStatus = 3;
            break;
        case 3:
            document.getElementById(id).innerText = 'wait....';
            loaderStatus = 0;
            break;
        default:
            document.getElementById(id).innerText = 'wait.....';
            loaderStatus = 0;
      }
    },
    getFundings = () => {
	  getFundsRoute = 'https://charity-funding-bsc.herokuapp.com/api/v1/user/funding';
    fetch(getFundsRoute, {
      headers: {
        'Content-Type': 'application/json',
      },
    })
      .then(res => res.json())
      .then((data, res) => {
		console.log(data.data.funding);
        const fundingList = document.getElementById("funding-list");
        fundingList.innerHTML = "";
        data.data.funding.forEach(element => {
            fundingList.innerHTML += `
            <div class="card border-0 shadow-sm  mt-5">
                <div class="card-body">
                    <h3>Account detail</h3>
                    <p>${element.description.substr(0,100)} <br/><a href="account-detail.html?id=${element._id}">Read more</a></p>
                    <a href="https://charity-funding-bsc.herokuapp.com/proof/${element.proof}" target="_blank">account proof</a>
                    <div class="row mt-4">
                        <div class="col-1">
                        </div>
                        <div class="col-5">
                            <input type="number" class="form-control" placeholder="Vote count" id="vc-${element.address}">
                        </div>
                        <div class="col-5">
                            <button type="submit" class="btn btn-primary btn-round vote" data-address="${element.address}" id="vb-${element.address}">Vote</button>
                        </div>
                    </div>
                    <br/>
                    <button type="button" class="btn btn-info mt-4" disabled=${!element.isactivated}>Fund</button>
                </div>
            </div>
            `
        });
        const accountVotes = document.getElementsByClassName('vote');
        Array.from(accountVotes).forEach((element) => {
            element.addEventListener('click', voteAccount);
        });
		// document.getElementById("v-alw").innerHTML = data.data[0];
        return '';
      });
  },
  voteAccount = (e) => {
    const address = e.target.getAttribute("data-address");
    console.log(address);
    // setErrorNotification("invalid vote casted");
    startLoader = setInterval(loader, 500, `vb-${address}`);
    const token = `Bearer ${localStorage.getItem('token')}`,
    headers = new Headers({
        'content-type': 'application/json',
		authorization: token
      }),
    amount = document.getElementById(`vc-${address}`).value,
	voteAccountRoute = `https://charity-funding-bsc.herokuapp.com/api/v1/user/vote/${address}/${amount}`;
    if(!token) {
        window.location.href = "login.html";
    }
    if(amount > 0 && amount <= 10) {
      fetch(voteAccountRoute, {
        headers,
        })
      .then(res => res.json())
      .then((data, res) => {
          console.log(data.status);
        if (data.status == 0) {
			window.location.href = "login.html";
		} else {
            console.log(data.data.funding);
            const vote_status = data.data.message;
            setSuccessNotification(vote_status || "vote casted successfully");
            clearInterval(startLoader);
            document.getElementById(`vb-${address}`).innerText = 'Vote';
            return '';
        }
      });
    } else {
        setErrorNotification("invalid vote casted");
        clearInterval(startLoader);
        document.getElementById(`vb-${address}`).innerText = 'Vote';
        return;
    }
  };
  window.onload = () => {
	// checkIt();
	getFundings();
};
</script>
</body>
</html>